<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GuardTime Client SDK 0.3: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>GuardTime Client SDK 0.3 Documentation</h1>  </div>
</div>
<div class="contents">
<p>This is reference manual for the GuardTime client SDK. The SDK offers functions and examples useful for developers who want to integrate GuardTime timestamps into their own applications.</p>
<p>Disclaimer: This is the first public release of the SDK. We expect to deliver updates based on feedback from the first users and cannot guarantee that the updated versions will maintain interface compatibility with the current release.</p>
<h2>Timestamps</h2>
<p>A timestamp contains the information to certify that some data existed in a given form at some given time in the past. Timestamps are normally issued by trusted third parties called Timestamping Authorities (TSAs). The main innovation in GuardTime timestamps is that the amount of trust in the TSA required from the customers is significantly reduced compared to the more traditional approaches.</p>
<p>The two main operations on timestamps are generation and verification. Generation of a timestamp involves cryptographically binding the data whose integrity is to be protected to the time value from a reliable source in a way that neither the data nor the time value could later be changed undetectably. Verification means checking that the binding is still intact.</p>
<p>To get a timestamp from a GuardTime timestamping service, the client application computes a hash value of the data to be timestamped and submits the hash value to the timestamping service. The service returns a timestamp binding the hash value to the current time. The interaction follows the standard timestamping protocol defined in the RFC 3161.</p>
<p>A hash value is like a digital fingerprint of the data. Given both the original data and the hash value, it is easy to verify that they match. Yet it is impossible to recover the original data from the hash value, much like it is not possible to reconstruct a person from his/her fingerprint. So, even confidential data can be timestamped without any fear of disclosure. It is also quite impossible to create two different documents having the same fingerprint.</p>
<p>Every month, GuardTime creates an Integrity Code and publishes it in several newspapers across the world. The Integrity Code is a summary of all timestamps issued by the GuardTime timestamping services. Any timestamp issued prior to the creation of the Integrity Code can be traced to it to unambiguously prove the timestamp's age and integrity.</p>
<p>The proof connecting the timestamp to the Integrity Code can be inserted back into the timestamp itself in a process we call extending the timestamp. An extended timestamp is completely independent of GuardTime. Only the original data, the timestamp and any copy of the newspaper where the Integrity Code is published will be necessary to prove the intgerity and the age of the document.</p>
<p>Until the Integrity Code is generated, the timestamps are protected by GuardTime's digital signature. Digitally signing timestamps is the most common mode of operation of TSAs. The independent proof of authenticity based on publically available data is what makes GuardTime's solution unique.</p>
<p>For convenience, GuardTime publishes an electronic archive containing all Integrity Codes since the launch of the service and all valid signing keys. This electronic archive can be used to automate mass verification of thousands of timestamps (whether extended or not) per second in a large archive.</p>
<div align="center">
<img src="TspOverview.png" alt="TspOverview.png"/>
</div>
 <h2>Structure</h2>
<p>For manageability, the GuardTime client SDK is split into several layers.</p>
<p><b>The Base API</b></p>
<p>The base API deals with the low-level details of handling the timestamps. The public interface of this layer is defined in the file <code><a class="el" href="gt__base_8h.html" title="GuardTime client SDK, public header file for base functions.">gt_base.h</a></code> and the implementation is provided in the library <code>libgtbase</code>.</p>
<p>The functions in this layer cover the follwoing functional areas:</p>
<ul>
<li>the <a class="el" href="group__timestamps.html">Timestamps</a> section describes the functions dealing with creation, encoding and decoding of timestamp objects;</li>
<li>the <a class="el" href="group__publications.html">Publications</a> section describes the functions for handling the electronic archives of Integrity Codes;</li>
<li>the <a class="el" href="group__verification.html">Verification</a> section describes the functions for verifying the validity of timestamps;</li>
<li>the <a class="el" href="group__common.html">Common</a> section collects various helper functions, such as for data hashing and error handling.</li>
</ul>
<p>The cryptographic functions in the base API rely on the OpenSSL library, which has to be available to your application. See the documentation for the header file for more details on this.</p>
<p><b>The HTTP Transport</b></p>
<p>This module deals with communicating to the GuardTime network over the HTTP protocol. The public interface of this layer is defined in the file <code><a class="el" href="gt__http_8h.html" title="GuardTime client SDK, public header file for HTTP transport module.">gt_http.h</a></code> and the implementation is provided in the library <code>libgthttp</code>.</p>
<p>Detailed documentation for this layer is available in the <a class="el" href="group__http.html">HTTP transport</a> section.</p>
<p>For actual network transport on Linux, this module relies on the cURL library, which has to be available to your application. On Windows, the module relies on WinINet which comes standard on all supported versions of Windows. See the documentation for the header file for more details on this.</p>
<p>The HTTP module also uses the base API for handling the timestamps.</p>
<p><b>The PNG Integration</b></p>
<p>This module deals with seamless embedding of GuardTime timestamps into PNG image files. The public interface of this layer is defined in the file <code><a class="el" href="gt__png_8h.html" title="GuardTime timestamping SDK, public header file for PNG integration.">gt_png.h</a></code> and the implementation is provided in the library <code>libgtpng</code>.</p>
<p>Detailed documentation for this module is available in the <a class="el" href="group__png.html">PNG integration</a> section.</p>
<p>This module does not have any external dependencies, but it does rely on the base API and the HTTP module.</p>
<p>We expect to provide similar modules for several other file formats in the next release of the GuardTime client SDK.</p>
<h2>Examples</h2>
<p>The SDK includes simple command line utilities for timestamping arbitrary files and verifying the timestamps.</p>
<p><b>Creating a timestamp</b></p>
<p>The timestamping utility is located in the file <code>src/http/http_create.c</code> within the SDK source code archive.</p>
<p>To compile the example under Linux, use a command along the lines of </p>
<div class="fragment"><pre class="fragment">        gcc http_create.c -o http_create -I/usr/local/gt/include \
        -L/usr/local/gt/lib -L/usr/local/curl/lib -L/usr/local/ssl/lib \
        -lgthttp -lgtbase -lcurl -lcrypto -lrt
</pre></div><p> (either with the backslashes or all on a single line) replacing <code>/usr/local/gt</code>, <code>/usr/local/curl</code> and <code>/usr/local/ssl</code> with the directories where you unpacked the GuardTime, cURL and OpenSSL libraries (you can skip the <code>/I</code> and <code>/L</code> options if you installed everything in standard system locations).</p>
<p>To compile the example under Windows, use a command along the lines of </p>
<div class="fragment"><pre class="fragment">        cl.exe http_create.c /MT /I C:\gt\include
        /link /libpath:C:\gt\lib /libpath:C:\openssl\lib
        libgthttpMT.lib libgtbaseMT.lib libeay32MT.lib wininet.lib
        wsock32.lib wldap32.lib winmm.lib user32.lib gdi32.lib advapi32.lib
</pre></div><p> (all on a single line) replacing <code>C:\gt</code> and <code>C:\openssl</code> with the directories where you unpacked the GuardTime and OpenSSL libraries.</p>
<p>To run the compiled example, use a command along the lines of </p>
<div class="fragment"><pre class="fragment">        http_create data_in_file timestamp_out_file stamper_url
</pre></div><p> where the data is to be read from the file <code>data_in_file</code>, the timestamp is to be written to the file <code>timestamp_out_file</code> and the timestamping service is located at the URL <code>stamper_url</code>.</p>
<p>The core of the example is as follows: </p>
<div class="fragment"><pre class="fragment">        <span class="comment">// Error handling omitted for brevity</span>
        <span class="comment">// See the actual source code for full details</span>

        <span class="comment">// Hash the data file</span>
        <a class="code" href="group__common.html#ga3570d986dbe113cf94eca05ca7f68dfb">GT_hashFile</a>(in_file, <a class="code" href="group__common.html#gga5110e02245c37b4ff48ea4c4efb2924aab9f938a3bcdd62e6732ea0b7221e10fd">GT_HASHALG_DEFAULT</a>, &amp;data_hash);

        <span class="comment">// Get the timestamp</span>
        <a class="code" href="group__http.html#ga4e3e8302dd412eed484c83f600006dca">GTHTTP_createTimestampHash</a>(data_hash, tsa_url, &amp;timestamp);

        <span class="comment">// Encode the timestamp</span>
        <a class="code" href="group__timestamps.html#ga58dca66e7a9b95b22d65fba870b23b7c">GTTimestamp_getDEREncoded</a>(timestamp, &amp;der, &amp;der_len);

        <span class="comment">// Save the DER-encoded timestamp to a file</span>
        <a class="code" href="group__common.html#ga7837f369f5c83abadc08f6b55af31f30">GT_saveFile</a>(out_file, der, der_len);
</pre></div><p><b>Verifying a timestamp</b></p>
<p>The timestamp verification utility is located in the file <code>src/http/http_verify.c</code> within the SDK source code archive.</p>
<p>To compile the example under Linux, use a command along the lines of </p>
<div class="fragment"><pre class="fragment">        gcc http_verify.c -o http_verify -I/usr/local/gt/include \
        -L/usr/local/gt/lib -L/usr/local/curl/lib -L/usr/local/ssl/lib \
        -lgthttp -lgtbase -lcurl -lcrypto -lrt
</pre></div><p> (either with the backslashes or all on a single line) replacing <code>/usr/local/gt</code>, <code>/usr/local/curl</code> and <code>/usr/local/ssl</code> with the directories where you unpacked the GuardTime, cURL and OpenSSL libraries (you can skip the <code>/I</code> and <code>/L</code> option if you installed everything in standard system locations).</p>
<p>To compile the example under Windows, use a command along the lines of </p>
<div class="fragment"><pre class="fragment">        cl.exe http_verify.c /MT /I C:\gt\include
        /link /libpath:C:\gt\lib /libpath:C:\openssl\lib
        libgthttpMT.lib libgtbaseMT.lib libeay32MT.lib wininet.lib
        wsock32.lib wldap32.lib winmm.lib user32.lib gdi32.lib advapi32.lib
</pre></div><p> (all on a single line) replacing <code>C:\gt</code> and <code>C:\openssl</code> with the directories where you unpacked the GuardTime and OpenSSL libraries.</p>
<p>To run the compiled example, use a command along the lines of </p>
<div class="fragment"><pre class="fragment">        http_verify timestamp_in_file data_in_file publications_url verifier_url
</pre></div><p> where the timestamp is to be read from the file <code>timestamp_in_file</code>, the data is to be read from the file <code>data_in_file</code>, the publications list is to be retrieved from the URL <code>publications_url</code> and the online verifying service is located at the URL <code>verifier_url</code> (the last one is optional, specify <code>-</code> instead of the URL for offline verification).</p>
<p>The core of the example is as follows: </p>
<div class="fragment"><pre class="fragment">        <span class="comment">// Error handling omitted for brevity</span>
        <span class="comment">// See the actual source code for full details</span>

        <span class="comment">// Read the timestamp file</span>
        <a class="code" href="group__common.html#ga409dea240b5b501fa097de7c06705203">GT_loadFile</a>(timestamp_file, &amp;stamp_der, &amp;stamp_der_len);

        <span class="comment">// Decode the timestamp</span>
        <a class="code" href="group__timestamps.html#ga3215673483c473abcf6fe7dd6b7151b2">GTTimestamp_DERDecode</a>(stamp_der, stamp_der_len, &amp;timestamp);

        <span class="comment">// Hash the data file</span>
        <a class="code" href="group__timestamps.html#ga00fbe27df09c87517479d068afaf11a0">GTTimestamp_getAlgorithm</a>(timestamp, &amp;hash_algo);
        <a class="code" href="group__common.html#ga3570d986dbe113cf94eca05ca7f68dfb">GT_hashFile</a>(data_file, hash_algo, &amp;data_hash);

        <span class="comment">// Verify the timestamp</span>
        <a class="code" href="group__http.html#ga29c56b103ec317445b65f4ed80028313">GTHTTP_verifyTimestampHash</a>(timestamp, data_hash,
                verifier_url, NULL, NULL, publications_url, 0, &amp;ver);

        <span class="comment">// Display the results</span>
        <a class="code" href="group__verification.html#ga6c88243f78456ebc09cdc7854ade5589">GTVerificationInfo_print</a>(stderr, 0, ver);
        <span class="keywordflow">if</span> (ver-&gt;verification_errors == <a class="code" href="group__verification.html#gga00f17574800248075712b4aa9a3faf93ad0b3e065d9489145ca8dde0e85995a23">GT_NO_FAILURES</a>) {
                printf(<span class="stringliteral">&quot;Verification succeeded!\n&quot;</span>);
        }
</pre></div><h2>License</h2>
<p>Copyright 2008-2010 GuardTime AS</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a>.</p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<h2>Acknowledgements</h2>
<p>This product includes software developed by the OpenSSL Project for use in the OpenSSL Toolkit (<a href="http://www.openssl.org/">www.openssl.org</a>).</p>
<p>This product includes cryptographic software written by Eric Young (<a href="mailto:eay@cryptsoft.com">eay@cryptsoft.com</a>). This product includes software written by Tim Hudson (<a href="mailto:tjh@cryptsoft.com">tjh@cryptsoft.com</a>).</p>
<p>This product includes networking software developed by the cURL Project (<a href="http://curl.haxx.se/">curl.haxx.se</a>). </p>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 7 2010 16:12:24 for GuardTime Client SDK 0.3 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
