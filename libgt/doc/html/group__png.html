<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GuardTime Client SDK 0.3: PNG integration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>PNG integration</h1>  </div>
</div>
<div class="contents">

<p>Functions to support embedding of GuardTime timestamps into PNG image files.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#ga85c3c057105e954a4504dbe98ba9a2ba">GTPNG_VERSION</a>&#160;&#160;&#160;(0 &lt;&lt; 24 | 3 &lt;&lt; 16 | 8)</td></tr>
<tr><td colspan="2"><h2><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#ga70021c722b39d6b5945e9dd65b5d3b77">GTPNGStatusCode</a> { <br/>
&#160;&#160;<a class="el" href="group__png.html#gga70021c722b39d6b5945e9dd65b5d3b77a39011e68decc1c79ddc0424d9e42d581">GTPNG_BAD_DATA</a> =  GTPNG_LOWEST, 
<br/>
&#160;&#160;<a class="el" href="group__png.html#gga70021c722b39d6b5945e9dd65b5d3b77ae3e19c689f17d7a2ea6e13f8db297a1d">GTPNG_NO_GTTS</a>, 
<br/>
&#160;&#160;<a class="el" href="group__png.html#gga70021c722b39d6b5945e9dd65b5d3b77a20c972dfb42a0a00c24ee1f3382a270e">GTPNG_MULTIPLE_GTTS</a>, 
<br/>
&#160;&#160;<a class="el" href="group__png.html#gga70021c722b39d6b5945e9dd65b5d3b77a34a60e01de9485155446af3ee0d2cef6">GTPNG_GTTS_VERSION</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#ga6627f66b5eff92e2259d0e06f2790502">GTPNG_getErrorString</a> (int error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#ga912eedbe157a29e9b1b40d7438ccf7d4">GTPNG_getVersion</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#gad55b2f8d7d57cc8810515058d3c05f33">GTPNG_hash</a> (int hash_algorithm, void *img, size_t img_len, <a class="el" href="struct_g_t_message_digest__st.html">GTDataHash</a> **img_hash)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#gaa61d36d3d1f3a285c25a577c077329a7">GTPNG_insert</a> (void *img, size_t *img_len, size_t buf_len, const void *ts, size_t ts_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#ga0b290532190c3733d699af7c6cbbcd84">GTPNG_extract</a> (const void *img, size_t img_len, const void **ts, size_t *ts_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#gaa51ff47232930fe430e37cf13162e588">GTPNG_createTimestamp</a> (const void *img, size_t img_len, const char *url, void **img_ts, size_t *img_ts_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#ga529cb12b6beca769df8fe306c22e7ab5">GTPNG_extendTimestamp</a> (const void *img, size_t img_len, const char *url, void **img_ts, size_t *img_ts_len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__png.html#gaafa094593caab313f2d19188beefeb57">GTPNG_verifyTimestamp</a> (void *img, size_t img_len, const char *ext_url, <a class="el" href="group__timestamps.html#gaddb792efe52216386853c94e7aeaf6ba">GTTimestamp</a> **ext_ts, const <a class="el" href="group__publications.html#gacf561fdbce4067eb94bd9761a71e7e5a">GTPublicationsFile</a> *pub, const char *pub_url, int parse, <a class="el" href="struct_g_t_verification_info__st.html">GTVerificationInfo</a> **ver)</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The functions described in this group are declared in the <code><a class="el" href="gt__png_8h.html" title="GuardTime timestamping SDK, public header file for PNG integration.">gt_png.h</a></code> header file and implemented in the <code>libgtpng</code> library. For more implementation and usage details, see the notes for the header file.</p>
<p><b>Overview</b></p>
<p>PNG (Portable Network Graphics) is a file format for storing raster images. The normative reference for the PNG file format is <a href="http://www.w3.org/TR/PNG/" target="_blank">ISO/IEC 15948:2003</a>. A non-normative, but still widely cited reference is <a href="http://www.ietf.org/rfc/rfc2083.txt" target="_blank">RFC 2083</a>.</p>
<p>A PNG file consists of a fixed 8-byte header and a number of data chunks. Each data chunk consists of 4-byte length, 4-byte type tag, the content data, and 4-byte checksum.</p>
<p>The predefined types include a framework of adding textual meta-data to the file, but these fields are expected to contain plain text using ISO 8859-1 character set, which is not suitable for direct embedding of GuardTime timestamps. There's also a separate data type for the last modification time of the file, but this is defined to contain just date and time and is expected to be automatically updated by image manipulation tools.</p>
<p><b>The <code>gtTS</code> Data Chunk</b></p>
<p>Considering the above information, it seems best to use the extensible nature of the PNG format and define a new type for GuardTime timestamps.</p>
<p>Thus, GuardTime timestamps will be embedded in PNG files in chunks tagged <code>gtTS</code>. The choice of the letters is obvious: <code>gtTS</code> stands for <b>G</b>uard<b>T</b>ime <b>t</b>ime<b>s</b>tamp. The case of letters (formally the bit 5 of the corresponding byte) has the following meaning:</p>
<ol type="1">
<li>ancillary: value 1 (lower-case) means the data chunk is not critical for proper rendering of the image; viewers are safe to ignore the <code>gtTS</code> chunk if they don't recognize it;</li>
<li>private: value 1 (lower-case) means the type is a privately defined one, not part of the PNG specification;</li>
<li>reserved: all currently defined tags must use value 0 (upper-case);</li>
<li>no-copy: value 0 (upper-case) means the chunk should be discarded, not blindly copied, when the image is changed by an application that does not know how to keep the contents updated.</li>
</ol>
<p>The layout of the <code>gtTS</code> chunk is defined as follows:</p>
<ul>
<li>4-byte length of the content data (1 + the size of the timestamp itself);</li>
<li>4-byte type tag (the ASCII characters <code>g</code>, <code>t</code>, <code>T</code>, <code>S</code>; or the byte values 103, 116, 84, 83 in decimal; or the byte values 67, 74, 54, 53 in hexadecimal);</li>
<li>1-byte version number (byte value 1 for the current version of the specification);</li>
<li>the DER-encoded timestamp itself;</li>
<li>4-byte CRC32 checksum (computed over the type tag, version number, and timestamp).</li>
</ul>
<p><b>Timestamping</b></p>
<p>For timestamping, the whole contents of the original PNG image are hashed and the resulting hash value is submitted for timestamping. The timestamp is then wrapped into a <code>gtTS</code> chunk as described above and the chunk is inserted into the file. For extending, the original <code>gtTS</code> chunk is replaced with one containing the extended timestamp. For verification, the <code>gtTS</code> chunk is skipped over when hashing the file contents. The resulting hash value is then compared to the one extracted from the timestamp.</p>
<p>At most one <code>gtTS</code> chunk can appear in a PNG file. Multiple timestamps on a file are not supported, as that would make the verification and extension ambiguous.</p>
<p>While the reference implementation always inserts the <code>gtTS</code> chunk immediately before the terminating <code>IEND</code> chunk, this is not a requirement and verifiers must be able to extract an otherwise properly formatted <code>gtTS</code> chunk from any position after the starting <code>IHDR</code> and before the terminating <code>IEND</code> chunk. (It would be against the PNG specification to have any data chunk before the <code>IHDR</code> chunk or after the <code>IEND</code> chunk.)</p>
<p>Some data chunks in a PNG file can be re-ordered without affecting the rendering of the image. However, there is no way to detect the ordering requirements for unknown chunks. Therefore no normalization is attempted before hashing the file for either timestamping or verification. This brings a slight risk that loading a timestamped PNG file into some tool and saving it back without any changes will break the timestamp even though the information carried by the file has not changed. The alternative would be to sort the chunks in some fixed order and risk the possibility that someone manages to come up with a file where different orderings of the chunks yield different renderings of the image, but the timestamp would be insensitive to those. Clearly, the second risk is one we can't take and the first one is tolerable, especially considering the tool is encouraged to update the contents of the <code>tIME</code> chunk which would invalidate the timestamp in any case. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga85c3c057105e954a4504dbe98ba9a2ba"></a><!-- doxytag: member="gt_png.h::GTPNG_VERSION" ref="ga85c3c057105e954a4504dbe98ba9a2ba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GTPNG_VERSION&#160;&#160;&#160;(0 &lt;&lt; 24 | 3 &lt;&lt; 16 | 8)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Version number of the PNG module, as a 4-byte integer, with the major number in the highest, minor number in the second highest and build number in the two lowest bytes. The preprocessor macro is included to enable conditional compilation.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__png.html#ga912eedbe157a29e9b1b40d7438ccf7d4">GTPNG_getVersion</a>, <a class="el" href="group__common.html#gafdac78985a08fc5052b1d1f2888a25c9">GT_VERSION</a>, <a class="el" href="group__http.html#gacf85f4c0d316a03db66a8ef24ddf3411">GTHTTP_VERSION</a> </dd></dl>

</div>
</div>
<hr/><h2>Enumeration Type Documentation</h2>
<a class="anchor" id="ga70021c722b39d6b5945e9dd65b5d3b77"></a><!-- doxytag: member="gt_png.h::GTPNGStatusCode" ref="ga70021c722b39d6b5945e9dd65b5d3b77" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__png.html#ga70021c722b39d6b5945e9dd65b5d3b77">GTPNGStatusCode</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Status codes specific for the PNG integration.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__common.html#ga43b0c0f44bcf02caf0c2866b1f647a35">GTStatusCode</a> and <a class="el" href="group__http.html#ga9f42032eb2905e40ee6fe84e0dfc03c2">GTHTTPStatusCode</a>. </dd></dl>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="gga70021c722b39d6b5945e9dd65b5d3b77a39011e68decc1c79ddc0424d9e42d581"></a><!-- doxytag: member="GTPNG_BAD_DATA" ref="gga70021c722b39d6b5945e9dd65b5d3b77a39011e68decc1c79ddc0424d9e42d581" args="" -->GTPNG_BAD_DATA</em>&nbsp;</td><td>
<p>The image data passed in is not a valid PNG image. This result is returned if the image does not have the PNG file signature, does not have the IHDR and IEND chunks as the first and last ones in the file, or if any of the data chunks has an invalid length or fails the CRC check. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga70021c722b39d6b5945e9dd65b5d3b77ae3e19c689f17d7a2ea6e13f8db297a1d"></a><!-- doxytag: member="GTPNG_NO_GTTS" ref="gga70021c722b39d6b5945e9dd65b5d3b77ae3e19c689f17d7a2ea6e13f8db297a1d" args="" -->GTPNG_NO_GTTS</em>&nbsp;</td><td>
<p>The image data passed in does not contain any <code>gtTS</code> chunks. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga70021c722b39d6b5945e9dd65b5d3b77a20c972dfb42a0a00c24ee1f3382a270e"></a><!-- doxytag: member="GTPNG_MULTIPLE_GTTS" ref="gga70021c722b39d6b5945e9dd65b5d3b77a20c972dfb42a0a00c24ee1f3382a270e" args="" -->GTPNG_MULTIPLE_GTTS</em>&nbsp;</td><td>
<p>The image data passed in contains several <code>gtTS</code> chunks. Currently, we only allow one GuardTime timestamp in an image. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="gga70021c722b39d6b5945e9dd65b5d3b77a34a60e01de9485155446af3ee0d2cef6"></a><!-- doxytag: member="GTPNG_GTTS_VERSION" ref="gga70021c722b39d6b5945e9dd65b5d3b77a34a60e01de9485155446af3ee0d2cef6" args="" -->GTPNG_GTTS_VERSION</em>&nbsp;</td><td>
<p>Missing or unsupported version number in the <code>gtTS</code> chunk. Currently, only version 1 of the chunk is defined. </p>
</td></tr>
</table>
</dd>
</dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="gaa51ff47232930fe430e37cf13162e588"></a><!-- doxytag: member="gt_png.h::GTPNG_createTimestamp" ref="gaa51ff47232930fe430e37cf13162e588" args="(const void *img, size_t img_len, const char *url, void **img_ts, size_t *img_ts_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GTPNG_createTimestamp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"> <em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> <em>img_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"> <em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"> <em>img_ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"> <em>img_ts_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Creates a timestamp for a PNG file and inserts it into the file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">img</td><td><code></code>(in) - Pointer to the PNG image data. </td></tr>
    <tr><td class="paramname">img_len</td><td><code></code>(in) - Length of the PNG image data. </td></tr>
    <tr><td class="paramname">url</td><td><code></code>(in) - The signing service to use. </td></tr>
    <tr><td class="paramname">img_ts</td><td><code></code>(out) - Pointer that will receive pointer to the new timestamped image. Use <a class="el" href="group__common.html#ga0446e9253011a921665126e9f37016a1">GT_free()</a> to release the memory when done. </td></tr>
    <tr><td class="paramname">img_ts_len</td><td><code></code>(out) - Pointer that will receive the length of the new timestamped image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>status code (<code>GT_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga529cb12b6beca769df8fe306c22e7ab5"></a><!-- doxytag: member="gt_png.h::GTPNG_extendTimestamp" ref="ga529cb12b6beca769df8fe306c22e7ab5" args="(const void *img, size_t img_len, const char *url, void **img_ts, size_t *img_ts_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GTPNG_extendTimestamp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"> <em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> <em>img_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"> <em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"> <em>img_ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"> <em>img_ts_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Extends a timestamp for a PNG file and inserts it into the file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">img</td><td><code></code>(in) - Pointer to the PNG image data. </td></tr>
    <tr><td class="paramname">img_len</td><td><code></code>(in) - Length of the PNG image data. </td></tr>
    <tr><td class="paramname">url</td><td><code></code>(in) - The extending service to use. </td></tr>
    <tr><td class="paramname">img_ts</td><td><code></code>(out) - Pointer that will receive pointer to the new timestamped image. Use <a class="el" href="group__common.html#ga0446e9253011a921665126e9f37016a1">GT_free()</a> to release the memory when done. </td></tr>
    <tr><td class="paramname">img_ts_len</td><td><code></code>(out) - Pointer that will receive the length of the new timestamped image. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>status code (<code>GT_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga0b290532190c3733d699af7c6cbbcd84"></a><!-- doxytag: member="gt_png.h::GTPNG_extract" ref="ga0b290532190c3733d699af7c6cbbcd84" args="(const void *img, size_t img_len, const void **ts, size_t *ts_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GTPNG_extract </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"> <em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> <em>img_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void **&#160;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"> <em>ts_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Extracts the timestamp from the given PNG image. This function does not allocate any memory. The result points to the location of the timestamp within the given image buffer. If the image does not contain a timestamp, the pointer is set to <code>NULL</code>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">img</td><td><code></code>(in/out) - Pointer to the PNG image data. </td></tr>
    <tr><td class="paramname">img_len</td><td><code></code>(in/out) - Length of the PNG image data. </td></tr>
    <tr><td class="paramname">ts</td><td><code></code>(out) - Pointer that will receive pointer to the timestamp data. </td></tr>
    <tr><td class="paramname">ts_len</td><td><code></code>(out) - Pointer that will receive the length of the timestamp data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>status code (<code>GT_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="ga6627f66b5eff92e2259d0e06f2790502"></a><!-- doxytag: member="gt_png.h::GTPNG_getErrorString" ref="ga6627f66b5eff92e2259d0e06f2790502" args="(int error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* GTPNG_getErrorString </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"> <em>error</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Gets human readable error string in English.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">error</td><td><code></code>(in) - Status code from a GuardTime PNG function. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the error string (it is static, don't try to free it).</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>The functions in the PNG module may relay status codes from the base and HTTP modules. This function can handle the relayed codes as well.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__common.html#gaf03ec60bbbf4da31f46e6420ec7bb3d4">GT_getErrorString()</a>, <a class="el" href="group__http.html#ga3df4ff0f34f540e640e0cc2b7610d921">GTHTTP_getErrorString()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ga912eedbe157a29e9b1b40d7438ccf7d4"></a><!-- doxytag: member="gt_png.h::GTPNG_getVersion" ref="ga912eedbe157a29e9b1b40d7438ccf7d4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GTPNG_getVersion </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the version number of the library.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>version number of the PNG module, as a 4-byte integer, with the major number in the highest, minor number in the second highest and build number in the two lowest bytes.</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="group__png.html#ga85c3c057105e954a4504dbe98ba9a2ba">GTPNG_VERSION</a>, <a class="el" href="group__common.html#ga29f20e0dcc653a818552d01aa8b02369">GT_getVersion</a>, <a class="el" href="group__http.html#gaf8fed890ccd3245cc91dcf656f969f6f">GTHTTP_getVersion</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gad55b2f8d7d57cc8810515058d3c05f33"></a><!-- doxytag: member="gt_png.h::GTPNG_hash" ref="gad55b2f8d7d57cc8810515058d3c05f33" args="(int hash_algorithm, void *img, size_t img_len, GTDataHash **img_hash)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GTPNG_hash </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"> <em>hash_algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"> <em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> <em>img_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_t_message_digest__st.html">GTDataHash</a> **&#160;</td>
          <td class="paramname"> <em>img_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculates a hash of given PNG image, skipping over the <code>gtTS</code> chunk, if one is present.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">hash_algorithm</td><td><code></code>(in) - Identifier of the hash algorithm. See <a class="el" href="group__common.html#ga5110e02245c37b4ff48ea4c4efb2924a">GTHashAlgorithm</a> for possible values. </td></tr>
    <tr><td class="paramname">img</td><td><code></code>(in) - Pointer to the PNG image data to be hashed. Note that the pointer is NOT <code>const</code>. This is because the function actually does temporarily modify the buffer for implementation ease and efficiency. </td></tr>
    <tr><td class="paramname">img_len</td><td><code></code>(in) - Length of the PNG image data. </td></tr>
    <tr><td class="paramname">img_hash</td><td><code></code>(out) - Pointer that will receive pointer to the hash. Use <a class="el" href="group__common.html#gaff69acd5ef8287b0eca9fe14d3be5e57">GTDataHash_free()</a> to release the memory when done. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>status code (<code>GT_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a class="anchor" id="gaa61d36d3d1f3a285c25a577c077329a7"></a><!-- doxytag: member="gt_png.h::GTPNG_insert" ref="gaa61d36d3d1f3a285c25a577c077329a7" args="(void *img, size_t *img_len, size_t buf_len, const void *ts, size_t ts_len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GTPNG_insert </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"> <em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"> <em>img_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> <em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"> <em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> <em>ts_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Inserts the given timestamp into the given PNG image. This function does not allocate any memory. The given image buffer is updated in place and must be large enough to hold the result. If the image already contains a timestamp, it is quietly replaced with the new one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">img</td><td><code></code>(in/out) - Pointer to the PNG image data. </td></tr>
    <tr><td class="paramname">img_len</td><td><code></code>(in/out) - Pointer to the length of the PNG image data. The length is updated to reflect the new size of the image. </td></tr>
    <tr><td class="paramname">buf_len</td><td><code></code>(in) - Size of the buffer. The buffer must be large enough to hold the result. </td></tr>
    <tr><td class="paramname">ts</td><td><code></code>(in) - Pointer to the timestamp data. </td></tr>
    <tr><td class="paramname">ts_len</td><td><code></code>(in) - Length of the timestamp data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>status code (<code>GT_OK</code>, when operation succeeded, otherwise an error code; in particular <code>GT_OUT_OF_MEMORY</code> when the buffer is too small). </dd></dl>

</div>
</div>
<a class="anchor" id="gaafa094593caab313f2d19188beefeb57"></a><!-- doxytag: member="gt_png.h::GTPNG_verifyTimestamp" ref="gaafa094593caab313f2d19188beefeb57" args="(void *img, size_t img_len, const char *ext_url, GTTimestamp **ext_ts, const GTPublicationsFile *pub, const char *pub_url, int parse, GTVerificationInfo **ver)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GTPNG_verifyTimestamp </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"> <em>img</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"> <em>img_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"> <em>ext_url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__timestamps.html#gaddb792efe52216386853c94e7aeaf6ba">GTTimestamp</a> **&#160;</td>
          <td class="paramname"> <em>ext_ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__publications.html#gacf561fdbce4067eb94bd9761a71e7e5a">GTPublicationsFile</a> *&#160;</td>
          <td class="paramname"> <em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"> <em>pub_url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"> <em>parse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_g_t_verification_info__st.html">GTVerificationInfo</a> **&#160;</td>
          <td class="paramname"> <em>ver</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Verifies the given timestamped PNG image using the given publications file.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">img</td><td><code></code>(in) - Pointer to the PNG image data. </td></tr>
    <tr><td class="paramname">img_len</td><td><code></code>(in) - Length of the PNG image data. </td></tr>
    <tr><td class="paramname">ext_url</td><td><code></code>(in) - The URL of the extending service. If this is <code>NULL</code> and the timestamp should be extended to be verified, verification will fail. </td></tr>
    <tr><td class="paramname">ext_ts</td><td><code></code>(out) - The pointer that will receive a pointer to the extended timestamp if the timestamp is extended during verification. If the timestamp is not extended, *ext_ts will be set to <code>NULL</code>. If ext_ts is <code>NULL</code>, the extended timestamp is discarded. </td></tr>
    <tr><td class="paramname">pub</td><td><code></code>(in) - The publications file. Exactly one of <code>pub</code>, <code>pub_url</code> must be non-<code>NULL</code>. </td></tr>
    <tr><td class="paramname">pub_url</td><td><code></code>(in) - The URL to get the publications file from. Exactly one of <code>pub</code>, <code>pub_url</code> must be non-<code>NULL</code>. </td></tr>
    <tr><td class="paramname">parse</td><td><code></code>(in) - The <code>explicit_data</code> field of the verification info will be filled if this is non-zero. </td></tr>
    <tr><td class="paramname">ver</td><td><code></code>(out) - Pointer that will receive pointer to verification info. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>status code (<code>GT_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 7 2010 16:12:24 for GuardTime Client SDK 0.3 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
