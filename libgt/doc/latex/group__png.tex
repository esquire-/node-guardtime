\hypertarget{group__png}{
\section{PNG integration}
\label{group__png}\index{PNG integration@{PNG integration}}
}


Functions to support embedding of GuardTime timestamps into PNG image files.  


\subsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{group__png_ga85c3c057105e954a4504dbe98ba9a2ba}{GTPNG\_\-VERSION}~(0 $<$$<$ 24 $|$ 3 $<$$<$ 16 $|$ 8)
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{group__png_ga70021c722b39d6b5945e9dd65b5d3b77}{GTPNGStatusCode} \{ \par
\hyperlink{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a39011e68decc1c79ddc0424d9e42d581}{GTPNG\_\-BAD\_\-DATA} =  GTPNG\_\-LOWEST, 
\par
\hyperlink{group__png_gga70021c722b39d6b5945e9dd65b5d3b77ae3e19c689f17d7a2ea6e13f8db297a1d}{GTPNG\_\-NO\_\-GTTS}, 
\par
\hyperlink{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a20c972dfb42a0a00c24ee1f3382a270e}{GTPNG\_\-MULTIPLE\_\-GTTS}, 
\par
\hyperlink{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a34a60e01de9485155446af3ee0d2cef6}{GTPNG\_\-GTTS\_\-VERSION}
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
const char $\ast$ \hyperlink{group__png_ga6627f66b5eff92e2259d0e06f2790502}{GTPNG\_\-getErrorString} (int error)
\item 
int \hyperlink{group__png_ga912eedbe157a29e9b1b40d7438ccf7d4}{GTPNG\_\-getVersion} (void)
\item 
int \hyperlink{group__png_gad55b2f8d7d57cc8810515058d3c05f33}{GTPNG\_\-hash} (int hash\_\-algorithm, void $\ast$img, size\_\-t img\_\-len, \hyperlink{struct_g_t_message_digest__st}{GTDataHash} $\ast$$\ast$img\_\-hash)
\item 
int \hyperlink{group__png_gaa61d36d3d1f3a285c25a577c077329a7}{GTPNG\_\-insert} (void $\ast$img, size\_\-t $\ast$img\_\-len, size\_\-t buf\_\-len, const void $\ast$ts, size\_\-t ts\_\-len)
\item 
int \hyperlink{group__png_ga0b290532190c3733d699af7c6cbbcd84}{GTPNG\_\-extract} (const void $\ast$img, size\_\-t img\_\-len, const void $\ast$$\ast$ts, size\_\-t $\ast$ts\_\-len)
\item 
int \hyperlink{group__png_gaa51ff47232930fe430e37cf13162e588}{GTPNG\_\-createTimestamp} (const void $\ast$img, size\_\-t img\_\-len, const char $\ast$url, void $\ast$$\ast$img\_\-ts, size\_\-t $\ast$img\_\-ts\_\-len)
\item 
int \hyperlink{group__png_ga529cb12b6beca769df8fe306c22e7ab5}{GTPNG\_\-extendTimestamp} (const void $\ast$img, size\_\-t img\_\-len, const char $\ast$url, void $\ast$$\ast$img\_\-ts, size\_\-t $\ast$img\_\-ts\_\-len)
\item 
int \hyperlink{group__png_gaafa094593caab313f2d19188beefeb57}{GTPNG\_\-verifyTimestamp} (void $\ast$img, size\_\-t img\_\-len, const char $\ast$ext\_\-url, \hyperlink{group__timestamps_gaddb792efe52216386853c94e7aeaf6ba}{GTTimestamp} $\ast$$\ast$ext\_\-ts, const \hyperlink{group__publications_gacf561fdbce4067eb94bd9761a71e7e5a}{GTPublicationsFile} $\ast$pub, const char $\ast$pub\_\-url, int parse, \hyperlink{struct_g_t_verification_info__st}{GTVerificationInfo} $\ast$$\ast$ver)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The functions described in this group are declared in the {\ttfamily \hyperlink{gt__png_8h}{gt\_\-png.h}} header file and implemented in the {\ttfamily libgtpng} library. For more implementation and usage details, see the notes for the header file.

{\bfseries Overview}

PNG (Portable Network Graphics) is a file format for storing raster images. The normative reference for the PNG file format is \href{http://www.w3.org/TR/PNG/}{\tt ISO/IEC 15948:2003}. A non-\/normative, but still widely cited reference is \href{http://www.ietf.org/rfc/rfc2083.txt}{\tt RFC 2083}.

A PNG file consists of a fixed 8-\/byte header and a number of data chunks. Each data chunk consists of 4-\/byte length, 4-\/byte type tag, the content data, and 4-\/byte checksum.

The predefined types include a framework of adding textual meta-\/data to the file, but these fields are expected to contain plain text using ISO 8859-\/1 character set, which is not suitable for direct embedding of GuardTime timestamps. There's also a separate data type for the last modification time of the file, but this is defined to contain just date and time and is expected to be automatically updated by image manipulation tools.

{\bfseries The {\ttfamily gtTS} Data Chunk}

Considering the above information, it seems best to use the extensible nature of the PNG format and define a new type for GuardTime timestamps.

Thus, GuardTime timestamps will be embedded in PNG files in chunks tagged {\ttfamily gtTS}. The choice of the letters is obvious: {\ttfamily gtTS} stands for {\bfseries G}uard{\bfseries T}ime {\bfseries t}ime{\bfseries s}tamp. The case of letters (formally the bit 5 of the corresponding byte) has the following meaning:
\begin{DoxyEnumerate}
\item ancillary: value 1 (lower-\/case) means the data chunk is not critical for proper rendering of the image; viewers are safe to ignore the {\ttfamily gtTS} chunk if they don't recognize it;
\item private: value 1 (lower-\/case) means the type is a privately defined one, not part of the PNG specification;
\item reserved: all currently defined tags must use value 0 (upper-\/case);
\item no-\/copy: value 0 (upper-\/case) means the chunk should be discarded, not blindly copied, when the image is changed by an application that does not know how to keep the contents updated.
\end{DoxyEnumerate}

The layout of the {\ttfamily gtTS} chunk is defined as follows:
\begin{DoxyItemize}
\item 4-\/byte length of the content data (1 + the size of the timestamp itself);
\item 4-\/byte type tag (the ASCII characters {\ttfamily g}, {\ttfamily t}, {\ttfamily T}, {\ttfamily S}; or the byte values 103, 116, 84, 83 in decimal; or the byte values 67, 74, 54, 53 in hexadecimal);
\item 1-\/byte version number (byte value 1 for the current version of the specification);
\item the DER-\/encoded timestamp itself;
\item 4-\/byte CRC32 checksum (computed over the type tag, version number, and timestamp).
\end{DoxyItemize}

{\bfseries Timestamping}

For timestamping, the whole contents of the original PNG image are hashed and the resulting hash value is submitted for timestamping. The timestamp is then wrapped into a {\ttfamily gtTS} chunk as described above and the chunk is inserted into the file. For extending, the original {\ttfamily gtTS} chunk is replaced with one containing the extended timestamp. For verification, the {\ttfamily gtTS} chunk is skipped over when hashing the file contents. The resulting hash value is then compared to the one extracted from the timestamp.

At most one {\ttfamily gtTS} chunk can appear in a PNG file. Multiple timestamps on a file are not supported, as that would make the verification and extension ambiguous.

While the reference implementation always inserts the {\ttfamily gtTS} chunk immediately before the terminating {\ttfamily IEND} chunk, this is not a requirement and verifiers must be able to extract an otherwise properly formatted {\ttfamily gtTS} chunk from any position after the starting {\ttfamily IHDR} and before the terminating {\ttfamily IEND} chunk. (It would be against the PNG specification to have any data chunk before the {\ttfamily IHDR} chunk or after the {\ttfamily IEND} chunk.)

Some data chunks in a PNG file can be re-\/ordered without affecting the rendering of the image. However, there is no way to detect the ordering requirements for unknown chunks. Therefore no normalization is attempted before hashing the file for either timestamping or verification. This brings a slight risk that loading a timestamped PNG file into some tool and saving it back without any changes will break the timestamp even though the information carried by the file has not changed. The alternative would be to sort the chunks in some fixed order and risk the possibility that someone manages to come up with a file where different orderings of the chunks yield different renderings of the image, but the timestamp would be insensitive to those. Clearly, the second risk is one we can't take and the first one is tolerable, especially considering the tool is encouraged to update the contents of the {\ttfamily tIME} chunk which would invalidate the timestamp in any case. 

\subsection{Define Documentation}
\hypertarget{group__png_ga85c3c057105e954a4504dbe98ba9a2ba}{
\index{png@{png}!GTPNG\_\-VERSION@{GTPNG\_\-VERSION}}
\index{GTPNG\_\-VERSION@{GTPNG\_\-VERSION}!png@{png}}
\subsubsection[{GTPNG\_\-VERSION}]{\setlength{\rightskip}{0pt plus 5cm}\#define GTPNG\_\-VERSION~(0 $<$$<$ 24 $|$ 3 $<$$<$ 16 $|$ 8)}}
\label{group__png_ga85c3c057105e954a4504dbe98ba9a2ba}
Version number of the PNG module, as a 4-\/byte integer, with the major number in the highest, minor number in the second highest and build number in the two lowest bytes. The preprocessor macro is included to enable conditional compilation.

\begin{DoxySeeAlso}{See also}
\hyperlink{group__png_ga912eedbe157a29e9b1b40d7438ccf7d4}{GTPNG\_\-getVersion}, \hyperlink{group__common_gafdac78985a08fc5052b1d1f2888a25c9}{GT\_\-VERSION}, \hyperlink{group__http_gacf85f4c0d316a03db66a8ef24ddf3411}{GTHTTP\_\-VERSION} 
\end{DoxySeeAlso}


\subsection{Enumeration Type Documentation}
\hypertarget{group__png_ga70021c722b39d6b5945e9dd65b5d3b77}{
\index{png@{png}!GTPNGStatusCode@{GTPNGStatusCode}}
\index{GTPNGStatusCode@{GTPNGStatusCode}!png@{png}}
\subsubsection[{GTPNGStatusCode}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf GTPNGStatusCode}}}
\label{group__png_ga70021c722b39d6b5945e9dd65b5d3b77}
Status codes specific for the PNG integration.

\begin{DoxySeeAlso}{See also}
\hyperlink{group__common_ga43b0c0f44bcf02caf0c2866b1f647a35}{GTStatusCode} and \hyperlink{group__http_ga9f42032eb2905e40ee6fe84e0dfc03c2}{GTHTTPStatusCode}. 
\end{DoxySeeAlso}
\begin{Desc}
\item[Enumerator: ]\par
\begin{description}
\index{GTPNG\_\-BAD\_\-DATA@{GTPNG\_\-BAD\_\-DATA}!png@{png}}\index{png@{png}!GTPNG\_\-BAD\_\-DATA@{GTPNG\_\-BAD\_\-DATA}}\item[{\em 
\hypertarget{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a39011e68decc1c79ddc0424d9e42d581}{
GTPNG\_\-BAD\_\-DATA}
\label{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a39011e68decc1c79ddc0424d9e42d581}
}]The image data passed in is not a valid PNG image. This result is returned if the image does not have the PNG file signature, does not have the IHDR and IEND chunks as the first and last ones in the file, or if any of the data chunks has an invalid length or fails the CRC check. \index{GTPNG\_\-NO\_\-GTTS@{GTPNG\_\-NO\_\-GTTS}!png@{png}}\index{png@{png}!GTPNG\_\-NO\_\-GTTS@{GTPNG\_\-NO\_\-GTTS}}\item[{\em 
\hypertarget{group__png_gga70021c722b39d6b5945e9dd65b5d3b77ae3e19c689f17d7a2ea6e13f8db297a1d}{
GTPNG\_\-NO\_\-GTTS}
\label{group__png_gga70021c722b39d6b5945e9dd65b5d3b77ae3e19c689f17d7a2ea6e13f8db297a1d}
}]The image data passed in does not contain any {\ttfamily gtTS} chunks. \index{GTPNG\_\-MULTIPLE\_\-GTTS@{GTPNG\_\-MULTIPLE\_\-GTTS}!png@{png}}\index{png@{png}!GTPNG\_\-MULTIPLE\_\-GTTS@{GTPNG\_\-MULTIPLE\_\-GTTS}}\item[{\em 
\hypertarget{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a20c972dfb42a0a00c24ee1f3382a270e}{
GTPNG\_\-MULTIPLE\_\-GTTS}
\label{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a20c972dfb42a0a00c24ee1f3382a270e}
}]The image data passed in contains several {\ttfamily gtTS} chunks. Currently, we only allow one GuardTime timestamp in an image. \index{GTPNG\_\-GTTS\_\-VERSION@{GTPNG\_\-GTTS\_\-VERSION}!png@{png}}\index{png@{png}!GTPNG\_\-GTTS\_\-VERSION@{GTPNG\_\-GTTS\_\-VERSION}}\item[{\em 
\hypertarget{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a34a60e01de9485155446af3ee0d2cef6}{
GTPNG\_\-GTTS\_\-VERSION}
\label{group__png_gga70021c722b39d6b5945e9dd65b5d3b77a34a60e01de9485155446af3ee0d2cef6}
}]Missing or unsupported version number in the {\ttfamily gtTS} chunk. Currently, only version 1 of the chunk is defined. \end{description}
\end{Desc}



\subsection{Function Documentation}
\hypertarget{group__png_gaa51ff47232930fe430e37cf13162e588}{
\index{png@{png}!GTPNG\_\-createTimestamp@{GTPNG\_\-createTimestamp}}
\index{GTPNG\_\-createTimestamp@{GTPNG\_\-createTimestamp}!png@{png}}
\subsubsection[{GTPNG\_\-createTimestamp}]{\setlength{\rightskip}{0pt plus 5cm}int GTPNG\_\-createTimestamp (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{ img, }
\item[{size\_\-t}]{ img\_\-len, }
\item[{const char $\ast$}]{ url, }
\item[{void $\ast$$\ast$}]{ img\_\-ts, }
\item[{size\_\-t $\ast$}]{ img\_\-ts\_\-len}
\end{DoxyParamCaption}
)}}
\label{group__png_gaa51ff47232930fe430e37cf13162e588}
Creates a timestamp for a PNG file and inserts it into the file.


\begin{DoxyParams}{Parameters}
{\em img} & {\ttfamily }(in) -\/ Pointer to the PNG image data. \\
\hline
{\em img\_\-len} & {\ttfamily }(in) -\/ Length of the PNG image data. \\
\hline
{\em url} & {\ttfamily }(in) -\/ The signing service to use. \\
\hline
{\em img\_\-ts} & {\ttfamily }(out) -\/ Pointer that will receive pointer to the new timestamped image. Use \hyperlink{group__common_ga0446e9253011a921665126e9f37016a1}{GT\_\-free()} to release the memory when done. \\
\hline
{\em img\_\-ts\_\-len} & {\ttfamily }(out) -\/ Pointer that will receive the length of the new timestamped image. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code ({\ttfamily GT\_\-OK}, when operation succeeded, otherwise an error code). 
\end{DoxyReturn}
\hypertarget{group__png_ga529cb12b6beca769df8fe306c22e7ab5}{
\index{png@{png}!GTPNG\_\-extendTimestamp@{GTPNG\_\-extendTimestamp}}
\index{GTPNG\_\-extendTimestamp@{GTPNG\_\-extendTimestamp}!png@{png}}
\subsubsection[{GTPNG\_\-extendTimestamp}]{\setlength{\rightskip}{0pt plus 5cm}int GTPNG\_\-extendTimestamp (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{ img, }
\item[{size\_\-t}]{ img\_\-len, }
\item[{const char $\ast$}]{ url, }
\item[{void $\ast$$\ast$}]{ img\_\-ts, }
\item[{size\_\-t $\ast$}]{ img\_\-ts\_\-len}
\end{DoxyParamCaption}
)}}
\label{group__png_ga529cb12b6beca769df8fe306c22e7ab5}
Extends a timestamp for a PNG file and inserts it into the file.


\begin{DoxyParams}{Parameters}
{\em img} & {\ttfamily }(in) -\/ Pointer to the PNG image data. \\
\hline
{\em img\_\-len} & {\ttfamily }(in) -\/ Length of the PNG image data. \\
\hline
{\em url} & {\ttfamily }(in) -\/ The extending service to use. \\
\hline
{\em img\_\-ts} & {\ttfamily }(out) -\/ Pointer that will receive pointer to the new timestamped image. Use \hyperlink{group__common_ga0446e9253011a921665126e9f37016a1}{GT\_\-free()} to release the memory when done. \\
\hline
{\em img\_\-ts\_\-len} & {\ttfamily }(out) -\/ Pointer that will receive the length of the new timestamped image. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code ({\ttfamily GT\_\-OK}, when operation succeeded, otherwise an error code). 
\end{DoxyReturn}
\hypertarget{group__png_ga0b290532190c3733d699af7c6cbbcd84}{
\index{png@{png}!GTPNG\_\-extract@{GTPNG\_\-extract}}
\index{GTPNG\_\-extract@{GTPNG\_\-extract}!png@{png}}
\subsubsection[{GTPNG\_\-extract}]{\setlength{\rightskip}{0pt plus 5cm}int GTPNG\_\-extract (
\begin{DoxyParamCaption}
\item[{const void $\ast$}]{ img, }
\item[{size\_\-t}]{ img\_\-len, }
\item[{const void $\ast$$\ast$}]{ ts, }
\item[{size\_\-t $\ast$}]{ ts\_\-len}
\end{DoxyParamCaption}
)}}
\label{group__png_ga0b290532190c3733d699af7c6cbbcd84}
Extracts the timestamp from the given PNG image. This function does not allocate any memory. The result points to the location of the timestamp within the given image buffer. If the image does not contain a timestamp, the pointer is set to {\ttfamily NULL}.


\begin{DoxyParams}{Parameters}
{\em img} & {\ttfamily }(in/out) -\/ Pointer to the PNG image data. \\
\hline
{\em img\_\-len} & {\ttfamily }(in/out) -\/ Length of the PNG image data. \\
\hline
{\em ts} & {\ttfamily }(out) -\/ Pointer that will receive pointer to the timestamp data. \\
\hline
{\em ts\_\-len} & {\ttfamily }(out) -\/ Pointer that will receive the length of the timestamp data. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code ({\ttfamily GT\_\-OK}, when operation succeeded, otherwise an error code). 
\end{DoxyReturn}
\hypertarget{group__png_ga6627f66b5eff92e2259d0e06f2790502}{
\index{png@{png}!GTPNG\_\-getErrorString@{GTPNG\_\-getErrorString}}
\index{GTPNG\_\-getErrorString@{GTPNG\_\-getErrorString}!png@{png}}
\subsubsection[{GTPNG\_\-getErrorString}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ GTPNG\_\-getErrorString (
\begin{DoxyParamCaption}
\item[{int}]{ error}
\end{DoxyParamCaption}
)}}
\label{group__png_ga6627f66b5eff92e2259d0e06f2790502}
Gets human readable error string in English.


\begin{DoxyParams}{Parameters}
{\em error} & {\ttfamily }(in) -\/ Status code from a GuardTime PNG function. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the error string (it is static, don't try to free it).
\end{DoxyReturn}
\begin{DoxyNote}{Note}
The functions in the PNG module may relay status codes from the base and HTTP modules. This function can handle the relayed codes as well.
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__common_gaf03ec60bbbf4da31f46e6420ec7bb3d4}{GT\_\-getErrorString()}, \hyperlink{group__http_ga3df4ff0f34f540e640e0cc2b7610d921}{GTHTTP\_\-getErrorString()} 
\end{DoxySeeAlso}
\hypertarget{group__png_ga912eedbe157a29e9b1b40d7438ccf7d4}{
\index{png@{png}!GTPNG\_\-getVersion@{GTPNG\_\-getVersion}}
\index{GTPNG\_\-getVersion@{GTPNG\_\-getVersion}!png@{png}}
\subsubsection[{GTPNG\_\-getVersion}]{\setlength{\rightskip}{0pt plus 5cm}int GTPNG\_\-getVersion (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}
\label{group__png_ga912eedbe157a29e9b1b40d7438ccf7d4}
Returns the version number of the library.

\begin{DoxyReturn}{Returns}
version number of the PNG module, as a 4-\/byte integer, with the major number in the highest, minor number in the second highest and build number in the two lowest bytes.
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{group__png_ga85c3c057105e954a4504dbe98ba9a2ba}{GTPNG\_\-VERSION}, \hyperlink{group__common_ga29f20e0dcc653a818552d01aa8b02369}{GT\_\-getVersion}, \hyperlink{group__http_gaf8fed890ccd3245cc91dcf656f969f6f}{GTHTTP\_\-getVersion} 
\end{DoxySeeAlso}
\hypertarget{group__png_gad55b2f8d7d57cc8810515058d3c05f33}{
\index{png@{png}!GTPNG\_\-hash@{GTPNG\_\-hash}}
\index{GTPNG\_\-hash@{GTPNG\_\-hash}!png@{png}}
\subsubsection[{GTPNG\_\-hash}]{\setlength{\rightskip}{0pt plus 5cm}int GTPNG\_\-hash (
\begin{DoxyParamCaption}
\item[{int}]{ hash\_\-algorithm, }
\item[{void $\ast$}]{ img, }
\item[{size\_\-t}]{ img\_\-len, }
\item[{{\bf GTDataHash} $\ast$$\ast$}]{ img\_\-hash}
\end{DoxyParamCaption}
)}}
\label{group__png_gad55b2f8d7d57cc8810515058d3c05f33}
Calculates a hash of given PNG image, skipping over the {\ttfamily gtTS} chunk, if one is present.


\begin{DoxyParams}{Parameters}
{\em hash\_\-algorithm} & {\ttfamily }(in) -\/ Identifier of the hash algorithm. See \hyperlink{group__common_ga5110e02245c37b4ff48ea4c4efb2924a}{GTHashAlgorithm} for possible values. \\
\hline
{\em img} & {\ttfamily }(in) -\/ Pointer to the PNG image data to be hashed. Note that the pointer is NOT {\ttfamily const}. This is because the function actually does temporarily modify the buffer for implementation ease and efficiency. \\
\hline
{\em img\_\-len} & {\ttfamily }(in) -\/ Length of the PNG image data. \\
\hline
{\em img\_\-hash} & {\ttfamily }(out) -\/ Pointer that will receive pointer to the hash. Use \hyperlink{group__common_gaff69acd5ef8287b0eca9fe14d3be5e57}{GTDataHash\_\-free()} to release the memory when done. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code ({\ttfamily GT\_\-OK}, when operation succeeded, otherwise an error code). 
\end{DoxyReturn}
\hypertarget{group__png_gaa61d36d3d1f3a285c25a577c077329a7}{
\index{png@{png}!GTPNG\_\-insert@{GTPNG\_\-insert}}
\index{GTPNG\_\-insert@{GTPNG\_\-insert}!png@{png}}
\subsubsection[{GTPNG\_\-insert}]{\setlength{\rightskip}{0pt plus 5cm}int GTPNG\_\-insert (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{ img, }
\item[{size\_\-t $\ast$}]{ img\_\-len, }
\item[{size\_\-t}]{ buf\_\-len, }
\item[{const void $\ast$}]{ ts, }
\item[{size\_\-t}]{ ts\_\-len}
\end{DoxyParamCaption}
)}}
\label{group__png_gaa61d36d3d1f3a285c25a577c077329a7}
Inserts the given timestamp into the given PNG image. This function does not allocate any memory. The given image buffer is updated in place and must be large enough to hold the result. If the image already contains a timestamp, it is quietly replaced with the new one.


\begin{DoxyParams}{Parameters}
{\em img} & {\ttfamily }(in/out) -\/ Pointer to the PNG image data. \\
\hline
{\em img\_\-len} & {\ttfamily }(in/out) -\/ Pointer to the length of the PNG image data. The length is updated to reflect the new size of the image. \\
\hline
{\em buf\_\-len} & {\ttfamily }(in) -\/ Size of the buffer. The buffer must be large enough to hold the result. \\
\hline
{\em ts} & {\ttfamily }(in) -\/ Pointer to the timestamp data. \\
\hline
{\em ts\_\-len} & {\ttfamily }(in) -\/ Length of the timestamp data. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code ({\ttfamily GT\_\-OK}, when operation succeeded, otherwise an error code; in particular {\ttfamily GT\_\-OUT\_\-OF\_\-MEMORY} when the buffer is too small). 
\end{DoxyReturn}
\hypertarget{group__png_gaafa094593caab313f2d19188beefeb57}{
\index{png@{png}!GTPNG\_\-verifyTimestamp@{GTPNG\_\-verifyTimestamp}}
\index{GTPNG\_\-verifyTimestamp@{GTPNG\_\-verifyTimestamp}!png@{png}}
\subsubsection[{GTPNG\_\-verifyTimestamp}]{\setlength{\rightskip}{0pt plus 5cm}int GTPNG\_\-verifyTimestamp (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{ img, }
\item[{size\_\-t}]{ img\_\-len, }
\item[{const char $\ast$}]{ ext\_\-url, }
\item[{{\bf GTTimestamp} $\ast$$\ast$}]{ ext\_\-ts, }
\item[{const {\bf GTPublicationsFile} $\ast$}]{ pub, }
\item[{const char $\ast$}]{ pub\_\-url, }
\item[{int}]{ parse, }
\item[{{\bf GTVerificationInfo} $\ast$$\ast$}]{ ver}
\end{DoxyParamCaption}
)}}
\label{group__png_gaafa094593caab313f2d19188beefeb57}
Verifies the given timestamped PNG image using the given publications file.


\begin{DoxyParams}{Parameters}
{\em img} & {\ttfamily }(in) -\/ Pointer to the PNG image data. \\
\hline
{\em img\_\-len} & {\ttfamily }(in) -\/ Length of the PNG image data. \\
\hline
{\em ext\_\-url} & {\ttfamily }(in) -\/ The URL of the extending service. If this is {\ttfamily NULL} and the timestamp should be extended to be verified, verification will fail. \\
\hline
{\em ext\_\-ts} & {\ttfamily }(out) -\/ The pointer that will receive a pointer to the extended timestamp if the timestamp is extended during verification. If the timestamp is not extended, $\ast$ext\_\-ts will be set to {\ttfamily NULL}. If ext\_\-ts is {\ttfamily NULL}, the extended timestamp is discarded. \\
\hline
{\em pub} & {\ttfamily }(in) -\/ The publications file. Exactly one of {\ttfamily pub}, {\ttfamily pub\_\-url} must be non-\/{\ttfamily NULL}. \\
\hline
{\em pub\_\-url} & {\ttfamily }(in) -\/ The URL to get the publications file from. Exactly one of {\ttfamily pub}, {\ttfamily pub\_\-url} must be non-\/{\ttfamily NULL}. \\
\hline
{\em parse} & {\ttfamily }(in) -\/ The {\ttfamily explicit\_\-data} field of the verification info will be filled if this is non-\/zero. \\
\hline
{\em ver} & {\ttfamily }(out) -\/ Pointer that will receive pointer to verification info. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
status code ({\ttfamily GT\_\-OK}, when operation succeeded, otherwise an error code). 
\end{DoxyReturn}
